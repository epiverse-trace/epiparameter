<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>{epiparameter} Extraction Bias Analysis • epiparameter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="{epiparameter} Extraction Bias Analysis">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epiparameter</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epiparameter.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Intro</h6></li>
    <li><a class="dropdown-item" href="../articles/extract_convert.html">Parameter extraction and conversion in {epiparameter}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Epiparameter Data</h6></li>
    <li><a class="dropdown-item" href="../articles/data_protocol.html">Data Collation and Synthesis Protocol</a></li>
    <li><a class="dropdown-item" href="../articles/database.html">Current database</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6></li>
    <li><a class="dropdown-item" href="../articles/data_from_epireview.html">Using {epireview} with {epiparameter}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Auxiliary</h6></li>
    <li><a class="dropdown-item" href="../articles/extract-bias.html">{epiparameter} Extraction Bias Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design_principles.html">Design Principles for {epiparameter}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/epiparameter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>{epiparameter} Extraction Bias Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epiparameter/blob/main/vignettes/extract-bias.Rmd" class="external-link"><code>vignettes/extract-bias.Rmd</code></a></small>
      <div class="d-none name"><code>extract-bias.Rmd</code></div>
    </div>

    
    
<div class="alert alert-info">
<p>If you are unfamiliar with the parameter extraction functionality in
{epiparameter} the <a href="extract_convert.html">Conversion and
Extraction vignette</a> is a great place to start.</p>
</div>
<p>The {epiparameter} R package contains a set of functions to extract
parameters of probability distributions given a set of summary
statistics. These summary statistics can be the values at given
percentiles of a distribution, or the median and range of a data set to
which a distribution can be fit. Using these and specifying the
distribution (e.g. gamma, lognormal, etc.) the parameters of the
distribution can be extracted by optimisation using least-squares.</p>
<p>The precision and bias of this approach needs to be explored across
the parameter space of the different distributions to understand
potential erroneous inferences. This vignette aims to explore this
inference bias for three distributions currently supported in
{epiparameter} for parameter extraction: gamma, lognormal and Weibull.
Extraction of parameters from a normal distribution is also supported in
{epiparameter} but we do not test that in this vignette.</p>
<div class="alert alert-warning">
<p>This is not an in depth analysis of the estimation methods
implemented in {epiparameter}, but rather a supplementary article
exploring the bias and precision of the functions. It is specific to the
case of {epiparameter} and should not be taken as a generalisable
result.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="extraction-bias">Extraction Bias<a class="anchor" aria-label="anchor" href="#extraction-bias"></a>
</h2>
<div class="section level3">
<h3 id="extraction-by-percentiles">Extraction by percentiles<a class="anchor" aria-label="anchor" href="#extraction-by-percentiles"></a>
</h3>
<p>First we explore extraction from percentiles.</p>
<p>If a study reports the percentiles of a distribution, they are
usually symmetrical (e.g. 5th and 95th, or 2.5th and 97.5th). However,
in a few instances, only asymmetrical percentiles are available. We test
whether asymmetry to varying degrees influences the bias of parameter
extraction for all distributions.</p>
<p>We set up the parameter space to explore:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">"lnorm"</span>, <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="va">dist_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">lower_percentiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">upper_percentiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">95</span>, <span class="fl">97.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parameters_perc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="va">distributions</span>,</span>
<span>  param_1 <span class="op">=</span> <span class="va">dist_parameters</span>,</span>
<span>  param_2 <span class="op">=</span> <span class="va">dist_parameters</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">lower_percentiles</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">upper_percentiles</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the degree of asymmetry for each percentile combination</span></span>
<span><span class="va">lw_interval_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">0</span> <span class="op">-</span> <span class="va">parameters_perc</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span></span>
<span><span class="va">up_interval_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">parameters_perc</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span></span>
<span><span class="va">deg_asym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">lw_interval_diff</span> <span class="op">-</span> <span class="va">up_interval_diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add degree of asymmetry to percentiles</span></span>
<span><span class="va">parameters_perc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">parameters_perc</span>, <span class="va">deg_asym</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># divide percentiles by 100 to make them probabilities for quantile functions</span></span>
<span><span class="va">parameters_perc</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">parameters_perc</span><span class="op">$</span><span class="va">lower</span> <span class="op">/</span> <span class="fl">100</span></span>
<span><span class="va">parameters_perc</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">parameters_perc</span><span class="op">$</span><span class="va">upper</span> <span class="op">/</span> <span class="fl">100</span></span></code></pre></div>
<p>Now we can run the extraction for each point in parameter space. We
set a seed to control for stochasticity when estimating the parameters,
however changing or removing the seed should not drastically change the
results or interpretation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estim_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through parameter space estimating parameters</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">params_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"dist"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">percen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="st">"upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"lnorm"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        p <span class="op">=</span> <span class="va">percen</span>,</span>
<span>        meanlog <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>        sdlog <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        p <span class="op">=</span> <span class="va">percen</span>,</span>
<span>        shape <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>        scale <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># message about stochastic optimisation suppressed</span></span>
<span>  <span class="va">estim_params</span><span class="op">[[</span><span class="va">params_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>      type <span class="op">=</span> <span class="st">"percentiles"</span>,</span>
<span>      values <span class="op">=</span> <span class="va">true_values</span>,</span>
<span>      distribution <span class="op">=</span> <span class="va">dist</span>,</span>
<span>      percentiles <span class="op">=</span> <span class="va">percen</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># combine results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">parameters_perc</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">estim_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dist"</span>, <span class="st">"param_1"</span>, <span class="st">"param_2"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>,</span>
<span>  <span class="st">"deg_asym"</span>, <span class="st">"estim_param_1"</span>, <span class="st">"estim_param_2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate absolute difference between true parameter and estimated value</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  diff_param_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">param_1</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">estim_param_1</span><span class="op">)</span>,</span>
<span>  diff_param_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">param_2</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">estim_param_2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/extract_param.html">extract_param()</a></code> function re-runs the optimisation
until convergence to a set tolerance is achieved (or a maximum number of
iterations is reached) to more reliably return the global optimum. In
theory, this should help to minimise bias and instability in the
parameter estimation. See the function documentation
(<code>?extract_param()</code>) or the <a href="extract_convert.html">Conversion and Extraction vignette</a> for
more details.</p>
<p>The extraction bias can be explored:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot differences by distribution</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">diff_param_1</span>,</span>
<span>    y <span class="op">=</span> <span class="va">diff_param_2</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">deg_asym</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 1 Difference (|true - estimated|)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 2 Difference (|true - estimated|)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Percentile Asym."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure%2Fplot-results-percentiles-1.png" alt="Parameter estimation bias facetted by distribution. Parameter 1 is either the shape parameter, for gamma and Weibull distributions, or meanlog for the lognormal distribution. Parameter 2 is either the scale parameter for gamma and Weibull distributions, or sdlog for the lognormal distribution."><div class="figcaption">Parameter estimation bias facetted by
distribution. Parameter 1 is either the shape parameter, for gamma and
Weibull distributions, or meanlog for the lognormal distribution.
Parameter 2 is either the scale parameter for gamma and Weibull
distributions, or sdlog for the lognormal distribution.</div>
</div>
</div>
<div class="section level3">
<h3 id="extraction-by-median-and-range">Extraction by median and range<a class="anchor" aria-label="anchor" href="#extraction-by-median-and-range"></a>
</h3>
<p>The same analysis as above can be repeated, this time using the other
summary statistic possibly reported in studies: median and range of
data. For this extraction the number of samples used to infer the
distribution is required as this can impact the possible range exhibited
by the data.</p>
<p>Set up the parameter space:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">parameters_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  dist <span class="op">=</span> <span class="va">distributions</span>, <span class="co"># same as above</span></span>
<span>  param_1 <span class="op">=</span> <span class="va">dist_parameters</span>, <span class="co"># same as above</span></span>
<span>  param_2 <span class="op">=</span> <span class="va">dist_parameters</span>, <span class="co"># same as above</span></span>
<span>  n_samples <span class="op">=</span> <span class="va">n_samples</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estim_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through parameter space estimating parameters</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">params_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"dist"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"n_samples"</span><span class="op">]</span></span>
<span>  <span class="co"># while loop to ensure values are min &lt; median &lt; max</span></span>
<span>  <span class="va">resample_values</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">resample_values</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"lnorm"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">true_median</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          meanlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          sdlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>          meanlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          sdlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">true_median</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          shape <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          scale <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>          shape <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          scale <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_median</span>, <span class="va">true_range</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">true_values</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">resample_values</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># message about stochastic optimisation suppressed</span></span>
<span>  <span class="va">estim_params</span><span class="op">[[</span><span class="va">params_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    expr <span class="op">=</span> <span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>      type <span class="op">=</span> <span class="st">"range"</span>,</span>
<span>      values <span class="op">=</span> <span class="va">true_values</span>,</span>
<span>      distribution <span class="op">=</span> <span class="va">dist</span>,</span>
<span>      samples <span class="op">=</span> <span class="va">n_samples</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning: Maximum optimisation iterations reached, returning result early. </span></span>
<span><span class="co">#&gt; Result may not be reliable.</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># combine results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">parameters_range</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">estim_params</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dist"</span>, <span class="st">"param_1"</span>, <span class="st">"param_2"</span>, <span class="st">"n_samples"</span>, <span class="st">"estim_param_1"</span>, <span class="st">"estim_param_2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate absolute difference between true parameter and estimated value</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  diff_param_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">param_1</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">estim_param_1</span><span class="op">)</span>,</span>
<span>  diff_param_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">param_2</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">estim_param_2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Plot results:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot differences by distribution</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">diff_param_1</span>,</span>
<span>      y <span class="op">=</span> <span class="va">diff_param_2</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">n_samples</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 1 Difference (|true - estimated|)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 2 Difference (|true - estimated|)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"No. Samples"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure%2Fplot-results-med-range-1.png" alt="Parameter extraction bias. Parameter 1 is either the shape parameter, for gamma and Weibull distributions, or meanlog for the lognormal distribution. Parameter 2 is either the scale parameter for gamma and Weibull distributions, or sdlog for the lognormal distribution."><div class="figcaption">Parameter extraction bias. Parameter 1 is either
the shape parameter, for gamma and Weibull distributions, or meanlog for
the lognormal distribution. Parameter 2 is either the scale parameter
for gamma and Weibull distributions, or sdlog for the lognormal
distribution.</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="extraction-precision">Extraction precision<a class="anchor" aria-label="anchor" href="#extraction-precision"></a>
</h2>
<div class="section level3">
<h3 id="extraction-by-percentiles-1">Extraction by percentiles<a class="anchor" aria-label="anchor" href="#extraction-by-percentiles-1"></a>
</h3>
<p>The two analyses above used a single extraction (replicate), however,
it may be that the estimation of the parameters is unstable for a given
set of percentiles or median range. Therefore, we finish with a test of
whether repeated extraction of parameters from a single percentile has
large variance which would indicate the parameter extraction is
unstable, imprecise, and potentially untrustworthy.</p>
<p>We use the same parameter space for percentiles as defined above
(<code>parameters_perc</code>). Now we can run the extraction for a set
of replicates to compute the variance of parameter estimates over those
replicates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estim_param_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through parameter space estimating parameters</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">params_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"dist"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">percen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="st">"upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"lnorm"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        p <span class="op">=</span> <span class="va">percen</span>,</span>
<span>        meanlog <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>        sdlog <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        p <span class="op">=</span> <span class="va">percen</span>,</span>
<span>        shape <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>        scale <span class="op">=</span> <span class="va">parameters_perc</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># message about stochastic optimisation suppressed</span></span>
<span>  <span class="va">estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      expr <span class="op">=</span> <span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>        type <span class="op">=</span> <span class="st">"percentiles"</span>,</span>
<span>        values <span class="op">=</span> <span class="va">true_values</span>,</span>
<span>        distribution <span class="op">=</span> <span class="va">dist</span>,</span>
<span>        percentiles <span class="op">=</span> <span class="va">percen</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">estim_param_var</span><span class="op">[[</span><span class="va">params_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">estim</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># combine results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">parameters_perc</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">estim_param_var</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dist"</span>, <span class="st">"param_1"</span>, <span class="st">"param_2"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>,</span>
<span>  <span class="st">"deg_asym"</span>, <span class="st">"estim_param_1_var"</span>, <span class="st">"estim_param_2_var"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">estim_param_1_var</span>,</span>
<span>    y <span class="op">=</span> <span class="va">estim_param_2_var</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">deg_asym</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 1 Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 2 Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Percentile Asym."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure%2Fplot-results-1.png" alt="Parameter extraction precision, facetted by distribution. Parameter 1 is either the shape parameter, for gamma and Weibull distributions, or meanlog for the lognormal distribution. Parameter 2 is either the scale parameter for gamma and Weibull distributions, or sdlog for the lognormal distribution."><div class="figcaption">Parameter extraction precision, facetted by
distribution. Parameter 1 is either the shape parameter, for gamma and
Weibull distributions, or meanlog for the lognormal distribution.
Parameter 2 is either the scale parameter for gamma and Weibull
distributions, or sdlog for the lognormal distribution.</div>
</div>
</div>
<div class="section level3">
<h3 id="extraction-by-median-and-range-1">Extraction by median and range<a class="anchor" aria-label="anchor" href="#extraction-by-median-and-range-1"></a>
</h3>
<p>The same test of estimation precision can be performed for the
extraction from median and range.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estim_param_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through parameter space estimating parameters</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">params_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"dist"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"n_samples"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># while loop to ensure values are min &lt; median &lt; max</span></span>
<span>  <span class="va">resample_values</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">resample_values</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"lnorm"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">true_median</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          meanlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          sdlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>          meanlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          sdlog <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">true_median</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          shape <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          scale <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>          shape <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_1"</span><span class="op">]</span>,</span>
<span>          scale <span class="op">=</span> <span class="va">parameters_range</span><span class="op">[</span><span class="va">params_idx</span>, <span class="st">"param_2"</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">true_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">true_range</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">true_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_median</span>, <span class="va">true_range</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">true_values</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">true_values</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">resample_values</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># message about stochastic optimisation suppressed</span></span>
<span>  <span class="va">estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      expr <span class="op">=</span> <span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>        type <span class="op">=</span> <span class="st">"range"</span>,</span>
<span>        values <span class="op">=</span> <span class="va">true_values</span>,</span>
<span>        distribution <span class="op">=</span> <span class="va">dist</span>,</span>
<span>        samples <span class="op">=</span> <span class="va">n_samples</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">estim_param_var</span><span class="op">[[</span><span class="va">params_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">estim</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning: Maximum optimisation iterations reached, returning result early. </span></span>
<span><span class="co">#&gt; Result may not be reliable.</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># combine results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">parameters_range</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">estim_param_var</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dist"</span>, <span class="st">"param_1"</span>, <span class="st">"param_2"</span>, <span class="st">"n_samples"</span>, <span class="st">"estim_param_1_var"</span>,</span>
<span>  <span class="st">"estim_param_2_var"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">estim_param_1_var</span>,</span>
<span>    y <span class="op">=</span> <span class="va">estim_param_2_var</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">n_samples</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 1 Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Parameter 2 Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"No. Samples"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure%2Fplot-estim-var-range-1.png" alt="Parameter extraction precision, facetted by distribution. Parameter 1 is either the shape parameter, for gamma and Weibull distributions, or meanlog for the lognormal distribution. Parameter 2 is either the scale parameter for gamma and Weibull distributions, or sdlog for the lognormal distribution."><div class="figcaption">Parameter extraction precision, facetted by
distribution. Parameter 1 is either the shape parameter, for gamma and
Weibull distributions, or meanlog for the lognormal distribution.
Parameter 2 is either the scale parameter for gamma and Weibull
distributions, or sdlog for the lognormal distribution.</div>
</div>
<div class="alert alert-primary">
<p>From the plots in this vignette, the bias is low and precision is
high when extracting parameters from the gamma, lognormal and Weibull
distributions from both percentiles of the distribution and from median
and range of a data set.</p>
<p>The asymmetry of percentiles and sample size of the data does not
noticeably influence the bias in parameter extraction.</p>
<p>However, this does not ensure reliable extract for all use cases of
the <code><a href="../reference/extract_param.html">extract_param()</a></code> function and we recommend checking the
output for spurious results.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Carmen Tamayo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
