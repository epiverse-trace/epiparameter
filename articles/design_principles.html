<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Design Principles for {epiparameter} • epiparameter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Design Principles for {epiparameter}">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">epiparameter</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epiparameter.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Intro</h6></li>
    <li><a class="dropdown-item" href="../articles/extract_convert.html">Parameter extraction and conversion in {epiparameter}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Epiparameter Data</h6></li>
    <li><a class="dropdown-item" href="../articles/data_protocol.html">Data Collation and Synthesis Protocol</a></li>
    <li><a class="dropdown-item" href="../articles/database.html">Current database</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Handling data from other packages</h6></li>
    <li><a class="dropdown-item" href="../articles/data_from_epireview.html">Using {epireview} with {epiparameter}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Auxiliary</h6></li>
    <li><a class="dropdown-item" href="../articles/extract-bias.html">{epiparameter} Extraction Bias Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design_principles.html">Design Principles for {epiparameter}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/epiparameter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="design_principles_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="design_principles_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="design_principles_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="design_principles_files/vis-9.1.0/vis-network.min.js"></script><script src="design_principles_files/visNetwork-binding-2.1.2/visNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Design Principles for {epiparameter}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epiparameter/blob/v0.4.0/vignettes/design_principles.Rmd" class="external-link"><code>vignettes/design_principles.Rmd</code></a></small>
      <div class="d-none name"><code>design_principles.Rmd</code></div>
    </div>

    
    
<p>This vignette outlines the design decisions that have been taken
during the development of the {epiparameter} R package, and provides
some of the reasoning, and possible pros and cons of each decision.</p>
<p>This document is primarily intended to be read by those interested in
understanding the code within the package and for potential package
contributors.</p>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>The {epiparameter} R package is a library of epidemiological
parameters, and provides a class (i.e. data structure) and helper
functions for working with epidemiological parameters and distributions.
The <code>&lt;epiparameter&gt;</code> class is the main functional
object for working with epidemiological parameters and can hold
information on delay distributions (e.g. incubation period, serial
interval, onset-to-death distribution) and offspring distributions. The
class has a number of methods, including allowing the user to easily
calculate the PDF, CDF, and quantile, generate random numbers, calculate
the distribution mean, and plot the distribution. An
<code>&lt;epiparameter&gt;</code> object can be created with the
constructor function <code><a href="../reference/epiparameter.html">epiparameter()</a></code>, and if uncertain
whether an object is an <code>&lt;epiparameter&gt;</code>, it can be
validated with <code><a href="../reference/assert_epiparameter.html">assert_epiparameter()</a></code>.</p>
<p>The package also converts distribution parameters to summary
statistics, and vice versa. This is achieved either by conversion or
extraction and both of these methods and the functions used are
explained in the <a href="extract_convert.html">Parameter extraction and
conversion in {epiparameter} vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The output of the <code><a href="../reference/epiparameter.html">epiparameter()</a></code> constructor function is
an <code>&lt;epiparameter&gt;</code> object. This is a list of nine
elements, where each element is either a single type
(e.g. <code>character</code>), a non-nested <code>list</code> or another
class. Classes as <code>&lt;epiparameter&gt;</code> elements are used
when there is existing well developed infrastructure for handling
certain data types. The <code>$prod_dist</code> element uses a
distribution class – if there is a parameterised distribution available
– using either the <code>&lt;distribution&gt;</code> class from
{distributional} or the <code>&lt;distcrete&gt;</code> class from
{distcrete}. The <code>$citation</code> is handled using the
<code>&lt;bibentry&gt;</code> class from the {utils} package (included
as part of the base R recommended packages).</p>
<p>Other functions return the simplest type possible, this may be an
atomic vector (including single element vectors), or un-nested
lists.</p>
</div>
<div class="section level2">
<h2 id="package-architecture">Package architecture<a class="anchor" aria-label="anchor" href="#package-architecture"></a>
</h2>
<p>Much of the {epiparameter} package is centred around the
<code>&lt;epiparameter&gt;</code> class. Here is a diagram showing the
class with it’s S3 methods (the diagram below is interactive so can
adjusted if labels are overlapping).</p>
<pre><code><span><span class="co">#&gt; This diagram is out of date, as new methods have been added to the package which are not included.</span></span></code></pre>
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:768px;height:474.660074165637px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"group":["<epiparameter>","Getters","Getters","Getters","Getters","Modifiers","Modifiers","Modifiers","Distribution functions","Distribution functions","Distribution functions","Distribution functions","Distribution functions","Utilities","Utilities","Utilities","Utilities","Utilities","Utilities","Checkers","Checkers","Checkers","Checkers","Conversions","Conversions","Conversions","Coercion","Coercion"],"label":["<epiparameter>","Getters","family()","get_citation()","get_parameters()","Modifiers","discretise()","as.function()","Distribution functions","cdf()","density()","generate()","quantile()","Utilities","print()","plot()","mean()","c()","format()","Checkers","is_epiparameter()","is_parameterised()","is_truncated()","Conversions","convert_params_to_summary_stats()","convert_summary_stats_to_params()","Coercion","as.data.frame()"],"shape":["box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box"]},"edges":{"from":[1,2,2,2,1,6,6,1,9,9,9,9,1,14,14,14,14,14,1,20,20,20,1,24,24,1,27],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","font":{"size":18}},"manipulation":{"enabled":false},"groups":{"<epiparameter>":{"color":"#8DD3C7"},"Getters":{"color":"#FFFFB3"},"Modifiers":{"color":"#BEBADA"},"Distribution functions":{"color":"#FB8072"},"Utilities":{"color":"#80B1D3"},"Checkers":{"color":"#FDB462"},"Conversions":{"color":"#B3DE69"},"useDefaultGroups":true,"Coercion":{"color":"#FCCDE5"}}},"groups":["<epiparameter>","Getters","Modifiers","Distribution functions","Utilities","Checkers","Conversions","Coercion"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="design-decisions">Design decisions<a class="anchor" aria-label="anchor" href="#design-decisions"></a>
</h2>
<ul>
<li>
<p>The <code>&lt;epiparameter&gt;</code> class is designed to be a
core unit for working with epidemiological parameters. It is designed in
parallel to other epidemiological data structures such as a the
<code>&lt;contactmatrix&gt;</code> class from the <a href="https://socialcontactdata.github.io/contactmatrix/index.html" class="external-link">{contactmatrix}
R package</a>. The design principles of the
<code>&lt;epiparameter&gt;</code> class are aligned with the <a href="https://socialcontactdata.github.io/contactmatrix/articles/design-principles.html" class="external-link"><code>&lt;contactmatrix&gt;</code>
design principles</a>. These include:</p>
<ul>
<li>A <code>new_*&lt;class&gt;()</code> constructor</li>
<li>Two validation functions
<ul>
<li><code>assert_&lt;class&gt;()</code></li>
<li><code>test_&lt;class&gt;()</code></li>
</ul>
</li>
<li>An <code>is_&lt;class&gt;()</code> checker to determine if an object
is of a given class (without checking the validity of class)</li>
<li>Coercion generic <code>as_&lt;class&gt;()</code>.</li>
</ul>
</li>
<li><p>The conversion functions (<code>convert_*</code>) are S3 generic
functions with methods provided by {epiparameter} for
<code>character</code> and <code>&lt;epiparameter&gt;</code> input. This
follows the design pattern of other packages, such as <a href="https://dplyr.tidyverse.org/" class="external-link">{dplyr}</a>, which export their key
data transformation functions as S3 generics to allow other developers
to extend the conversions to other data objects.</p></li>
<li><p>The conversion functions are designed to have a single function
exported to the user for summary statistics to parameters, and another
function exported for parameters to summary statistics. These functions
use a <code><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch()</a></code> to dispatch to the internal conversion
functions. This provides a minimal number of conversion functions in the
package namespace compared to exporting a conversion function for every
distribution.</p></li>
<li><p>If there are a large number of entries returned when reading
epidemiological parameters from the library using the
<code><a href="../reference/epiparameter_db.html">epiparameter_db()</a></code> function, it can flood the console, due
to the default <code>list</code> printing in R. This is the reasoning
for the <code>&lt;multi_epiparameter&gt;</code> object which is a
minimal class to enable cleaner and more descriptive printing for a
large list of <code>&lt;epiparameter&gt;</code> objects. The
<code><a href="../reference/print.multi_epiparameter.html">print.multi_epiparameter()</a></code> prints a header with metadata on
the number of <code>&lt;epiparameter&gt;</code> objects and number of
diseases and epidemiological distributions in the list. It also lists
all the diseases and epidemiological parameters returned. The footer of
the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function states the number of
<code>&lt;epiparameter&gt;</code> objects not shown, guides to use
<code>print(n = ...)</code> and <code><a href="../reference/parameter_tbl.html">parameter_tbl()</a></code> and a link
to the online database vignette (<code>database.Rmd</code>). Information
in the header and footer considered metadata or advice is prefixed with
<code>#</code>.</p></li>
<li><p>The package uses S3 classes and S3 dispatch for exported
functions, and <code><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch()</a></code> and <code><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call()</a></code> for
dispatching to internal functions. This is because it is easier to
develop and debug internal functions that do not use S3 dispatch and
avoids having to ensure that S3 methods are registered. Examples of S3
dispatch for exported functions are <code><a href="../reference/get_parameters.html">get_parameters()</a></code> and
<code><a href="../reference/convert_summary_stats_to_params.html">convert_summary_stats_to_params()</a></code>. Examples of internal
dispatch using <code><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch()</a></code> and <code><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call()</a></code> are
<code>clean_params()</code> and
<code><a href="../reference/convert_params_to_summary_stats.html">convert_params_to_summary_stats.character()</a></code>.</p></li>
<li><p>The function naming convention is for internal functions to have
a dot (.) prefix (e.g. <code><a href="../reference/dot-convert_params_lnorm.html">.convert_params_lnorm()</a></code>). The only
function that breaks with this convention is
<code><a href="../reference/new_epiparameter.html">new_epiparameter()</a></code> as advanced users of the package may
want to call in the internal low-level constructor, and adding a dot
prefix to this function may make it harder for users to find.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>The aim is to restrict the number of dependencies to a minimal
required set for ease of maintenance. The current hard dependencies
are:</p>
<ul>
<li><a href="https://CRAN.R-project.org/package=checkmate" class="external-link">{checkmate}</a></li>
<li><a href="https://CRAN.R-project.org/package=distributional" class="external-link">{distributional}</a></li>
<li><a href="https://CRAN.R-project.org/package=distcrete" class="external-link">{distcrete}</a></li>
<li>{stats}</li>
<li>{utils}</li>
</ul>
<p>{stats} and {utils} are distributed with the R language so are viewed
as a lightweight dependencies, that should already be installed on a
user’s machine if they have R. {checkmate} is an input checking package
widely used across Epiverse-TRACE packages. {distributional} and
{distcrete} are used to import S3 classes for handling and working with
distributions. Both are required as only {distcrete} can handle
discretised distributions.</p>
<p>Currently {epiparameter} deviates from the <a href="https://epiverse-trace.github.io/blueprints/dependencies.html#base-r-support-schedule" class="external-link">Epiverse
policy on the number of previous R versions it supports</a>. The
{epiparameter} package requires R version &gt;= 4.1.0 which only
includes the current version and the last three minor R versions rather
than the policy of four minor versions, as of September 2024. The
reasons for this change is to enable usage of the base R pipe
(<code>|&gt;</code>).</p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>In addition to the <a href="https://github.com/epiverse-trace/.github/blob/main/CONTRIBUTING.md" class="external-link">package
contributing guide</a>, please refer to the <a href="https://epiverse-trace.github.io/epiparameter/articles/data_protocol.html#contributing-to-the-package">{epiparameter}
specific contributing guidelines for adding epidemiological parameter to
the package library</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Carmen Tamayo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
