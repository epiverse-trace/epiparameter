<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epiparameter">
<title>Introduction to epiparameter • epiparameter</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to epiparameter">
<meta property="og:description" content="epiparameter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epiparameter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/epiparameter.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_protocol.html">Data Collation and Synthesis Protocol</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/epiparameter/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to epiparameter</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/epiparameter/blob/HEAD/vignettes/epiparameter.Rmd" class="external-link"><code>vignettes/epiparameter.Rmd</code></a></small>
      <div class="d-none name"><code>epiparameter.Rmd</code></div>
    </div>

    
    
<p>This vignette will use a range of R packages for formatting data and
performing a range of calculations. These packages can be thought of as
either general data science tools, which will come from the <a href="https://www.tidyverse.org/" class="external-link"><em>tidyverse</em></a>, or tools
specific to epidemiological tasks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epiparameter" class="external-link">epiparameter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mrc-ide/EpiEstim" class="external-link">EpiEstim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">R0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a></span><span class="op">)</span> <span class="co"># nolint</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reconverse/incidence2" class="external-link">incidence2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: grates</span></span></code></pre></div>
<p><code>epiparameter</code> is an R package that contains a range of
delay distributions collated from peer-reviewed reports and
meta-analyses, as well as functions to extract the parameters of a
right-skewed parametric probability distribution from its percentiles or
a median and range. If you would like to contribute to the database on
delay distributions in this R package see the <a href="#contributing">contributing section</a> at the end of this
document.</p>
<p>Delay distributions included in <code>epiparameter</code>:</p>
<ul>
<li>incubation period: The time delay between the time of infection and
the onset of symptoms</li>
<li>onset to admission: The time delay between the time of symptom onset
to admission to hospital</li>
<li>onset to death: The time delay between the time of illness onset to
death</li>
<li>serial interval: The time delay between the onset of symptoms
between a primary case and a secondary case</li>
</ul>
<p>Delay distributions not included in <code>epiparameter</code> (for
now, but planned for future versions):</p>
<ul>
<li>Generation time: The time delay between the infection in a primary
case and the infection in a secondary case</li>
<li>Admission to death: The time delay between being admitted to
hospital and time of death</li>
<li>Admission to discharge: The duration of hospitalisation</li>
<li>Infectious period: The duration of which a infected person can
infect a second person (viral shedding)</li>
<li>Onset to confirmation: The time delay between the onset of symptoms
and the case confirmed, via laboratory assays</li>
<li>Mean period of immunity: Duration of the immunity after having an
infection. This can depend on the individual immune response to either
vaccination or infection and the rate of immunity decay (which is
influenced by individual variation and vaccine type) <span class="citation">(Antia et al. 2018)</span>
</li>
<li>Latency period: The time delay between the time of exposure and the
onset of becoming infectious</li>
</ul>
<p>Some of the delay distributions in <code>epiparameter</code> have
close relationships to others not included in the package. The
incubation period and latency period are linked, and in the case when
infectiousness and symptoms arise at the same time, are the same. The
incubation period is more commonly available, as the detection of
symptom onset is easier than the detection of infectiousness. Secondly,
the serial interval and generation time are closely related, with the
former being the onset of symptoms while the latter is the time of
infection. The serial interval is more regularly available, as time of
exposure is difficult to pinpoint exactly, and is often censored data.
The generation time is sometimes approximated by using the serial
interval instead, however, this can introduce biases when used for
calculating the reproduction number <span class="citation">(Britton and
Scalia Tomba 2019)</span>.</p>
<p>Below we explore some of the use-cases of <code>epiparameter</code>
in various epidemiological analysis pipelines.</p>
<div class="section level2">
<h2 id="extraction">Extract distribution parameters from percentiles or median and
range<a class="anchor" aria-label="anchor" href="#extraction"></a>
</h2>
<p>Studies usually report summary statistics for distributions they fit.
If the mean and variance (or equivalently standard deviation or
coefficient of variation) are provided these can easily be converted to
the parameters of a lognormal, gamma or weibull distribution.
<code>epiparameter</code> provides functions that calculate this
conversion. If percentiles, or the median and range are provided the
parameters of a distribution can be estimated. This functionality is
useful when new data arises but only the percentiles or median and range
are reported. <code>epiparameter</code> provides a function that allows
the parameters of the gamma, lognormal, and weibull distributions from
percentiles or median and ranges reported in the literature.</p>
<p>Below is an example of the 75th percentiles reported for a lognormal
distribution from <span class="citation">Nolen et al. (2016)</span> for
the incubation period for Monkeypox.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Monkeypox lnorm from 75% percentiles in WHO data</span></span>
<span><span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"percentiles"</span>,</span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lnorm"</span>,</span>
<span>  percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.875</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Stochastic numerical optimisation used. </span></span>
<span><span class="co">#&gt; Rerun function multiple times to check global optimum is found</span></span>
<span><span class="co">#&gt;   meanlog     sdlog </span></span>
<span><span class="co">#&gt; 2.1783528 0.3360684</span></span></code></pre></div>
<p>If instead of the percentiles, the median and range are provided, as
done by <span class="citation">Thornhill et al. (2022)</span> for
monkeypox, and we want to calculate the parameters of a lognormal
distribution, the same function can be applied.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Monkeypox lnorm from median and range in 2022:</span></span>
<span><span class="fu"><a href="../reference/extract_param.html">extract_param</a></span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"range"</span>,</span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lnorm"</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">23</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Stochastic numerical optimisation used. </span></span>
<span><span class="co">#&gt; Rerun function multiple times to check global optimum is found</span></span>
<span><span class="co">#&gt;   meanlog     sdlog </span></span>
<span><span class="co">#&gt; 1.9460763 0.4934769</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conversion-of-distribution-parameters-from-mean-and-standard-deviation">Conversion of distribution parameters from mean and standard
deviation<a class="anchor" aria-label="anchor" href="#conversion-of-distribution-parameters-from-mean-and-standard-deviation"></a>
</h2>
<p><code>epiparameter</code> provides functions to convert between the
parameters of a distribution and the mean and standard deviation of the
distribution. In the case where the mean and standard deviation for the
gamma distribution are provided, but the shape and scale are required
the <code><a href="../reference/gamma_meansd2shapescale.html">gamma_meansd2shapescale()</a></code> function can be used to
convert between the two. <span class="citation">Donnelly et al.
(2003)</span> provides the mean and variance of the gamma distribution
for the incubation period of SARS.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SARS gamma shape/scale from mean and sd</span></span>
<span><span class="fu"><a href="../reference/gamma_meansd2shapescale.html">gamma_meansd2shapescale</a></span><span class="op">(</span><span class="fl">6.37</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">16.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $shape</span></span>
<span><span class="co">#&gt; [1] 2.429754</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scale</span></span>
<span><span class="co">#&gt; [1] 2.621664</span></span></code></pre></div>
<p>The opposite transformation is also available with
<code><a href="../reference/gamma_shapescale2meansd.html">gamma_shapescale2meansd()</a></code>.</p>
<p>Converting between the parameters of the lognormal distribution and
the mean and standard deviation can also be accomplished with
<code><a href="../reference/lnorm_musigma2meansd.html">lnorm_musigma2meansd()</a></code>, while the reverse transformation
uses <code><a href="../reference/lnorm_meansd2musigma.html">lnorm_meansd2musigma()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="delay-distributions-for-informing-quarantine-period">Delay distributions for informing quarantine period<a class="anchor" aria-label="anchor" href="#delay-distributions-for-informing-quarantine-period"></a>
</h2>
<p>In epidemics, understanding the delay between becoming exposed to an
infectious disease and the onset of symptoms (i.e. incubation period) is
informative for defining a possible quarantine period. Quarantine for
exposed individuals are one of the most widely used nonpharmaceutical
interventions (NPIs) to suppress the transmission and bring the basic
reproduction number (<span class="math inline">\(R_0\)</span>) down. As
pointed out by <span class="citation">Nishiura (2009)</span> using a
right-skewed probability distribution there is a non-zero probability of
having extremely large quarantine periods (e.g. 100 days).</p>
<p>The <code>epiparameter</code> packages contains a range of
distributions for a variety of infectious diseases which can be used to
determine a quarantine period. This period will be defined by the
desired proportion of people that exit quarantine without later going on
to develop symptoms and infect others.</p>
<p>Here we will illustrate with an example using the SARS-CoV pathogen.
We can check what information we have in the <code>epiparameter</code>
database on the incubation period of SARS-CoV:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/list_distributions.html">list_distributions</a></span><span class="op">(</span>delay_dist <span class="op">=</span> <span class="st">"incubation"</span><span class="op">)</span></span></code></pre></div>
<p>We can see that on rows 16-17 we have two studies reporting the
incubation period for SARS-CoV. Here we will use the <span class="citation">Lessler et al. (2009)</span>. This will be the default
when specifying <code>SARS_CoV</code> as our pathogen of interest due to
it having the largest sample size.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get epidemiological parameters for incubation period without specifying study</span></span>
<span><span class="va">sars_cov_incub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"SARS_CoV"</span>, delay_dist <span class="op">=</span> <span class="st">"incubation"</span><span class="op">)</span></span></code></pre></div>
<p>To be sure we are extracting the correct study it is also possible
specify which study to use.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get epidemiological parameters for incubation period specifying study</span></span>
<span><span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span></span>
<span>  pathogen <span class="op">=</span> <span class="st">"SARS_CoV"</span>,</span>
<span>  delay_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"Lessler_etal"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify a different study</span></span>
<span><span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span></span>
<span>  pathogen <span class="op">=</span> <span class="st">"SARS_CoV"</span>,</span>
<span>  delay_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"Donnelly_etal"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we have a distribution, in this case the lognormal distribution
and its best-fit parameters for the incubation period. The distributions
easily be visualised.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sars_cov_incub</span><span class="op">)</span></span></code></pre></div>
<p>In order to determine the duration of a quarantine period for
SARS-CoV we can calculate the percentiles of the distribution. For
example, if we calculate the 95th percentile of the lognormal
distribution for our SARS-CoV example it is the number of days within
which 95% of individuals will have their incubation period elapsed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 90th, 95th and 99th percentile percentile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>  meanlog <span class="op">=</span> <span class="va">sars_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">sars_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Therefore, eight and half days of quarantine will capture just over
90% of symptom onset events. To increase that to 95% of people would
require 10.3 days, and the most extreme scenario in our example of 99%
of people would require a 15.3 day quarantine period.</p>
<p>Given the steps outlined above and the database of infectious
diseases that are provided in <code>epiparameter</code> it is possible
to juxtapose the incubation periods of different pathogens. Here we
demonstrate this with a comparison of SARS-CoV and MERS-CoV. Both are
corona viruses (from the genus <em>Betacoronavirus</em>), both are
zoonotic pathogens that have produced outbreaks to different
effects.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mers_cov_incub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"MERS_CoV"</span>, delay_dist <span class="op">=</span> <span class="st">"incubation"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mers_cov_incub</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 95th percentile for SARS-CoV-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  meanlog <span class="op">=</span> <span class="va">sars_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">sars_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 95th percentile for MERS-CoV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  meanlog <span class="op">=</span> <span class="va">mers_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">mers_cov_incub</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The 95th percentile of the SARS-CoV incubation period is slightly
longer at 10.3 days compared to MERS-CoV at 10.0. The implication of
this being that at a 95% threshold quarantine can be slightly shorter
for MERS.</p>
</div>
<div class="section level2">
<h2 id="delay-distributions-for-estimating-r_0-r_t-and-forecasting">Delay distributions for estimating <span class="math inline">\(R_0\)</span>, <span class="math inline">\(R_t\)</span> and forecasting<a class="anchor" aria-label="anchor" href="#delay-distributions-for-estimating-r_0-r_t-and-forecasting"></a>
</h2>
<p>In order to calculate the rate of transmission of an infectious
disease in the form of either the basic reproduction number (<span class="math inline">\(R_0\)</span>) (i.e. the average number of
secondary infections from a primary infection given an entirely
susceptible population) or the effective reproduction number (<span class="math inline">\(R_t\)</span>) (i.e. the average number of
secondary infections from a primary infection at a point in time
<em>t</em> given a partially susceptible population) it requires the
knowledge of certain delay distributions. In this demonstration we will
use three methods (R packages), <a href="https://cran.r-project.org/web/packages/EpiEstim/index.html" class="external-link"><code>EpiEstim</code></a>,
<a href="https://cran.r-project.org/web/packages/EpiNow2/index.html" class="external-link"><code>EpiNow2</code></a>,
and <a href="https://cran.r-project.org/web/packages/R0/index.html" class="external-link"><code>R0</code></a>
to explore the utility of delay distributions in the
<code>epiparameter</code> package for downstream analysis. More
information on methods used can be found in their respective
documentation as well as the <a href="https://epirhandbook.com/en/epidemic-modeling.html#epidemic-modeling" class="external-link">Epidemic
modelling chapter</a> of the <a href="https://epirhandbook.com/en/index.html" class="external-link">EpiRHandbook</a>.</p>
<p>The data used in these examples will come from either data stored in
the <code>EpiEstim</code>, <code>EpiNow2</code>, or <code>R0</code>
packages or will be loaded from the <a href="https://cran.r-project.org/web/packages/outbreaks/index.html" class="external-link"><code>outbreaks</code></a>
package.</p>
<div class="section level3">
<h3 id="epiestim-estimating-a-time-variable-r_t">
<code>EpiEstim</code>: estimating a time-variable <span class="math inline">\(R_t\)</span><a class="anchor" aria-label="anchor" href="#epiestim-estimating-a-time-variable-r_t"></a>
</h3>
<p><code>EpiEstim</code> provides a toolkit to quantify the
transmissibility of an infectious disease. The main function used in
this example is <code><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R()</a></code>. This uses data on case
incidence and serial interval (see <span class="citation">Cori et al.
(2013)</span> for details on methods). The incidence data used here is
from a potential SARS-CoV-2 cases from the NHS from the
<code>outbreaks</code> package
(<code><a href="https://rdrr.io/pkg/outbreaks/man/covid19_england_nhscalls_2020.html" class="external-link">?covid19_england_nhscalls_2020</a></code> for more information).</p>
<p>The serial interval can be specified by a parametric distribution and
its parameters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid19_england_nhscalls_2020"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create incidence data from linelist</span></span>
<span><span class="va">covid_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/incidence2/man/incidence.html" class="external-link">incidence</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">covid19_england_nhscalls_2020</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create tibble with correct column names for `EpiEstim`</span></span>
<span><span class="va">covid_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="va">covid_incidence</span><span class="op">$</span><span class="va">date_index</span>,</span>
<span>  I <span class="op">=</span> <span class="va">covid_incidence</span><span class="op">$</span><span class="va">count</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R</a></span><span class="op">(</span></span>
<span>  incid <span class="op">=</span> <span class="va">covid_incidence</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"parametric_si"</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html" class="external-link">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mean_si <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>    std_si <span class="op">=</span> <span class="fl">1.1</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `dates`.</span></span></code></pre></div>
<p>The mean and standard deviation of the distribution – for
<code>EpiEstim</code> this is a discrete gamma distribution – are
arbitrarily chosen. However, <code>epiparameter</code> provides a
library of serial interval parameters which can be extracted and used
for the reproduction number estimation.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/list_distributions.html">list_distributions</a></span><span class="op">(</span>delay_dist <span class="op">=</span> <span class="st">"serial_interval"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_si</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span></span>
<span>  pathogen <span class="op">=</span> <span class="st">"SARS_CoV_2_wildtype"</span>,</span>
<span>  delay_dist <span class="op">=</span> <span class="st">"serial_interval"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R</a></span><span class="op">(</span></span>
<span>  incid <span class="op">=</span> <span class="va">covid_incidence</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"parametric_si"</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html" class="external-link">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mean_si <span class="op">=</span> <span class="va">covid_si</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    std_si <span class="op">=</span> <span class="va">covid_si</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span></span></code></pre></div>
<p>The incidence data required for the calculation of <span class="math inline">\(R_t\)</span> is sometimes only available in a raw
data form, linelist. From this linelist the incidence data can be
extracted and used for the reproduction number calculation.</p>
</div>
<div class="section level3">
<h3 id="epinow2-estimating-a-real-time-r_t">
<code>EpiNow2</code>: estimating a real-time <span class="math inline">\(R_t\)</span><a class="anchor" aria-label="anchor" href="#epinow2-estimating-a-real-time-r_t"></a>
</h3>
<p><code>EpiNow2</code> is the second R package in this demonstration on
how data on epidemiological parameters (incubation period, serial
interval, etc.) can be used for estimating the effective reproduction
number (<span class="math inline">\(R_t\)</span>) which is used to
determine transmissibility of an epidemic and its real-time growth or
decline. <code>EpiNow2</code> differs from <code>EpiEstim</code> in its
incorporation of more delays (e.g. reporting delays) to produced less
biased estimates of <span class="math inline">\(R_t\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/get_generation_time.html">get_generation_time</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"SARS-CoV-2"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"ganyani"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/get_incubation_period.html">get_incubation_period</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"SARS-CoV-2"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"lauer"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/convert_to_logmean.html">convert_to_logmean</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/convert_to_logsd.html">convert_to_logsd</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sd_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate Rt by date of infection</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a></span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="va">generation_time</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">incubation_period</span>, <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/stan_opts.html">stan_opts</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="fl">750</span>, chains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  return_output <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="epiparameter_files/figure-html/plot%20epinow2-1.png" width="500px" style="display: block; margin: auto;"></p>
<p>In the example above the generation time and incubation period used
are stored in the <code>EpiNow2</code> package. However, data on these
distributions is limited and a more comprehensive library of
distributions would provide a more robust data source to make
calculations of <span class="math inline">\(R_t\)</span>. This is where
<code>epiparameter</code> comes in. In the example below the
distributions from <code>epiparameter</code> are used and the parameters
of the delay distributions need to be extracted and put into list format
for <code><a href="epiforecasts.io/EpiNow2/reference/epinow.html">epinow()</a></code>. For this example we use 0.1 as a the value of
standard deviation for the mean and standard deviation of the
distribution parameters as this information is not currently available
in <code>epiparameter</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span></span>
<span>  pathogen <span class="op">=</span> <span class="st">"SARS_CoV_2_wildtype"</span>,</span>
<span>  delay_dist <span class="op">=</span> <span class="st">"incubation"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">serial_interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span></span>
<span>  pathogen <span class="op">=</span> <span class="st">"SARS_CoV_2_wildtype"</span>,</span>
<span>  delay_dist <span class="op">=</span> <span class="st">"serial_interval"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/convert_to_logmean.html">convert_to_logmean</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/convert_to_logsd.html">convert_to_logsd</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sd_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># use lnorm_musigma2meansd() to convert the parameters of the lognormal to the</span></span>
<span><span class="co"># mean (expectation) and standard deviation</span></span>
<span><span class="va">serial_interval_mean_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lnorm_musigma2meansd.html">lnorm_musigma2meansd</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="va">serial_interval</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">serial_interval</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">incubation_period_mean_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lnorm_musigma2meansd.html">lnorm_musigma2meansd</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="va">incubation_period</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"meanlog"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">incubation_period</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for now serial interval is used in place of generation time</span></span>
<span><span class="va">generation_time_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">serial_interval_mean_sd</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">serial_interval_mean_sd</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  sd_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">incubation_period_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">incubation_period_mean_sd</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">incubation_period_mean_sd</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  sd_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate Rt by date of infection</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a></span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="va">generation_time_list</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">incubation_period_list</span>, <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu"><a href="epiforecasts.io/EpiNow2/reference/stan_opts.html">stan_opts</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="fl">750</span>, chains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  return_output <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimating-r_t-using-r0">Estimating <span class="math inline">\(R_t\)</span> using
<code>R0</code><a class="anchor" aria-label="anchor" href="#estimating-r_t-using-r0"></a>
</h3>
<p>The R package <code>R0</code> contains a set of functions to estimate
the basic reproduction number (<span class="math inline">\(R_0\)</span>)
and the effective reproduction number (<span class="math inline">\(R_t\)</span>). Here we demonstrate a calculate of
the time-varying <span class="math inline">\(R_t\)</span> using the
method of <span class="citation">Wallinga and Teunis (2004)</span>. This
method uses the epidemic curve of incidence data over the course of an
epidemic and the generation time. Here we calculate <span class="math inline">\(R_t\)</span> using data on the outbreak of ebola
from Sierra Leone from 2014 from <code>outbreaks</code>, and using the a
serial interval from <code>epiparameter</code> as a proxy for the
generation time.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ebola_sierraleone_2014"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/incidence2/man/incidence.html" class="external-link">incidence</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">ebola_sierraleone_2014</span>,</span>
<span>  date_index <span class="op">=</span> <span class="st">"date_of_onset"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># format incidence data for `estimate.R()`</span></span>
<span><span class="va">ebola_incidence_r0</span> <span class="op">&lt;-</span> <span class="va">ebola_incidence</span><span class="op">$</span><span class="va">count</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ebola_incidence_r0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ebola_incidence</span><span class="op">$</span><span class="va">date_index</span></span>
<span></span>
<span><span class="va">ebola_si</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"ebola"</span>, delay_dist <span class="op">=</span> <span class="st">"serial_interval"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">si_mean_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamma_shapescale2meansd.html">gamma_shapescale2meansd</a></span><span class="op">(</span></span>
<span>  shape <span class="op">=</span> <span class="va">ebola_si</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"shape"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">ebola_si</span><span class="op">$</span><span class="va">param</span><span class="op">[[</span><span class="st">"scale"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/generation.time.html" class="external-link">generation.time</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"gamma"</span>, val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">si_mean_sd</span><span class="op">$</span><span class="va">mean</span>, <span class="va">si_mean_sd</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The confidence interval for <span class="math inline">\(R_t\)</span>
is calculated using simulations and the number of iterations specified
by the argument <code>nsim</code>. Here we run a small number of
simulations for the purpose of demonstration, however, a larger number
of iterations is recommended (e.g. 10,000).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/estimate.R.html" class="external-link">estimate.R</a></span><span class="op">(</span></span>
<span>  epid <span class="op">=</span> <span class="va">ebola_incidence_r0</span>,</span>
<span>  GT <span class="op">=</span> <span class="va">mgt</span>,</span>
<span>  begin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  end <span class="op">=</span> <span class="fl">27</span>,</span>
<span>  methods <span class="op">=</span> <span class="st">"TD"</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">TD</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-of-different-epidemiological-parameters">Comparison of different epidemiological parameters<a class="anchor" aria-label="anchor" href="#comparison-of-different-epidemiological-parameters"></a>
</h2>
<p>The <code>epiparameter</code> database stores information on several
delay distributions. Parameters for a single delay distribution can be
extracted using <code><a href="../reference/epidist.html">epidist()</a></code>, but for comparison of all data
on a specific pathogen <code>pathogen_summary()</code> can be used.</p>
<p>The incubation period and serial interval can be compared for
Monkeypox.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"monkeypox"</span>, delay_dist <span class="op">=</span> <span class="st">"incubation"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/epidist.html">epidist</a></span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"monkeypox"</span>, delay_dist <span class="op">=</span> <span class="st">"serial_interval"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pathogen_summary</span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"monkeypox"</span><span class="op">)</span></span></code></pre></div>
<p>Comparison of incubation period, serial interval and onset to
hospital admission for ebola.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pathogen_summary</span><span class="op">(</span>pathogen <span class="op">=</span> <span class="st">"ebola"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>The default plotting range for time since infection is from zero to
ten days. This can be altered by specifying the <code>day_range</code>
argument when plotting an <code>epidist</code> object.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sars_cov_incub</span>, day_range <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="planned-development-for-epiparameter">Planned development for <code>epiparameter</code><a class="anchor" aria-label="anchor" href="#planned-development-for-epiparameter"></a>
</h2>
<ul>
<li>There is often uncertainty in the estimates of mean, median and
percentiles of a parametric distribution, such as the lognormal (e.g.
<span class="citation">Lessler et al. (2009)</span>). Currently,
<code>epiparameter</code> does not handle this uncertainty, but future
versions will incorporate this and allow the uncertainty to be
propagated to tools that use the delay distributions. For example,
<code>EpiEstim</code> can also estimate the reproduction number when
there is uncertainty in the serial interval (see example below), in a
future version of <code>epiparameter</code> the uncertainty in delay
distributions, including serial interval, will be included in the
database and will be available to use in these calculations.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Flu2009"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html" class="external-link">estimate_R</a></span><span class="op">(</span></span>
<span>  incid <span class="op">=</span> <span class="va">Flu2009</span><span class="op">$</span><span class="va">incidence</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"uncertain_si"</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html" class="external-link">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mean_si <span class="op">=</span> <span class="fl">2.6</span>,</span>
<span>    std_mean_si <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    min_mean_si <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    max_mean_si <span class="op">=</span> <span class="fl">4.2</span>,</span>
<span>    std_si <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    std_std_si <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    min_std_si <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    max_std_si <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing to library of delay distributions<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>If you would like to contribute to the different delay distributions
stored in the <code>epiparameter</code> package, you can access the <a href="https://docs.google.com/spreadsheets/d/1VzC8NFHSQYPKsiDnxA7gDsm4cVr79outKQZJP8cC7Ro/edit?usp=sharing" class="external-link">google
sheet</a> and add your data.</p>
<p>Notes on the the spreadsheet:</p>
<ul>
<li><p>Most studies will report the distribution(s) they fitted to the
data. In the case that the study did not report the distribution of the
reported parameters or summary statistics (mean and standard deviation
of the distribution) the distribution can be assumed (e.g. by looking at
the shape of the distribution from figures in the paper). When a
distribution is being assumed and not explicitly stated please add this
assumption to the notes section of the spreadsheet. We are only
interested in studies that report the distribution fitted to the data.
This will ensure that if this data is used in another application the
user can be alerted that the distribution is assumed and not known with
certainty.</p></li>
<li><p>Shape and scale columns are the parameters of the gamma
distribution, while meanlog and sdlog columns are the parameters of the
lognormal distribution. In some cases these values will not be reported
in the study but can be extracted using the <code>epiparameter</code>
function <code><a href="../reference/extract_param.html">extract_param()</a></code> using either reported percentiles
or median and range (see <a href="#extraction">extraction
section</a>)</p></li>
<li><p>The extracted column refers to whether the distribution
parameters are explicitly stated in the paper, in which case the
extracted column should be “no”, or are extracted from summary
statistics using function in the package, in which case the extracted
column is “yes”</p></li>
<li><p>Discretised is to indicate whether the study fitted a discrete
distribution</p></li>
<li><p>Phase_bias means the study adjusted for a either a rising or
falling epidemic, which can bias incubation period estimates. Most
studies will not adjust for this bias.</p></li>
</ul>
<p>If fields are not known from a study, either put “NA” or “not yet
checked”. We are also happy to receive papers which report these delay
distributions and can add them to the database ourselves.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-antia_heterogeneity_2018" class="csl-entry">
Antia, A., H. Ahmed, A. Handel, N. E. Carlson, I. J. Amanna, R. Antia,
and M. Slifka. 2018. <a href="https://doi.org/10.1371/journal.pbio.2006601" class="external-link">Heterogeneity and
longevity of antibody memory to viruses and vaccines</a>. PLOS Biology
16:e2006601.
</div>
<div id="ref-britton_estimation_2019" class="csl-entry">
Britton, T., and G. Scalia Tomba. 2019. <a href="https://doi.org/10.1098/rsif.2018.0670" class="external-link">Estimation in emerging
epidemics: Biases and remedies</a>. Journal of The Royal Society
Interface 16:20180670.
</div>
<div id="ref-cori_new_2013" class="csl-entry">
Cori, A., N. M. Ferguson, C. Fraser, and S. Cauchemez. 2013. <a href="https://doi.org/10.1093/aje/kwt133" class="external-link">A <span>New</span>
<span>Framework</span> and <span>Software</span> to
<span>Estimate</span> <span>Time</span>-<span>Varying</span>
<span>Reproduction</span> <span>Numbers</span> <span>During</span>
<span>Epidemics</span></a>. American Journal of Epidemiology
178:1505–1512.
</div>
<div id="ref-donnelly_epidemiological_2003" class="csl-entry">
Donnelly, C. A., A. C. Ghani, G. M. Leung, A. J. Hedley, C. Fraser, S.
Riley, L. J. Abu-Raddad, L.-M. Ho, T.-Q. Thach, P. Chau, K.-P. Chan,
T.-H. Lam, L.-Y. Tse, T. Tsang, S.-H. Liu, J. H. Kong, E. M. Lau, N. M.
Ferguson, and R. M. Anderson. 2003. <a href="https://doi.org/10.1016/S0140-6736(03)13410-1" class="external-link">Epidemiological
determinants of spread of causal agent of severe acute respiratory
syndrome in <span>Hong</span> <span>Kong</span></a>. The Lancet
361:1761–1766.
</div>
<div id="ref-lessler_incubation_2009" class="csl-entry">
Lessler, J., N. G. Reich, R. Brookmeyer, T. M. Perl, K. E. Nelson, and
D. A. Cummings. 2009. <a href="https://doi.org/10.1016/S1473-3099(09)70069-6" class="external-link">Incubation periods
of acute respiratory viral infections: A systematic review</a>. The
Lancet Infectious Diseases 9:291–300.
</div>
<div id="ref-nishiura_determination_2009" class="csl-entry">
Nishiura, H. 2009. <a href="https://doi.org/10.1016/j.ijheh.2007.10.003" class="external-link">Determination of the
appropriate quarantine period following smallpox exposure:
<span>An</span> objective approach using the incubation period
distribution</a>. International Journal of Hygiene and Environmental
Health 212:97–104.
</div>
<div id="ref-nolen_extended_2016" class="csl-entry">
Nolen, L. D., L. Osadebe, J. Katomba, J. Likofata, D. Mukadi, B. Monroe,
J. Doty, C. M. Hughes, J. Kabamba, J. Malekani, P. L. Bomponda, J. I.
Lokota, M. P. Balilo, T. Likafi, R. S. Lushima, B. K. Ilunga, F. Nkawa,
E. Pukuta, S. Karhemere, J.-J. M. Tamfum, B. Nguete, E. O. Wemakoy, A.
M. McCollum, and M. G. Reynolds. 2016. <a href="https://doi.org/10.3201/eid2206.150579" class="external-link">Extended
<span>Human</span>-to-<span>Human</span> <span>Transmission</span>
during a <span>Monkeypox</span> <span>Outbreak</span> in the
<span>Democratic</span> <span>Republic</span> of the
<span>Congo</span></a>. Emerging Infectious Diseases 22:1014–1021.
</div>
<div id="ref-thornhill_monkeypox_2022" class="csl-entry">
Thornhill, J. P., S. Barkati, S. Walmsley, J. Rockstroh, A. Antinori, L.
B. Harrison, R. Palich, A. Nori, I. Reeves, M. S. Habibi, V. Apea, C.
Boesecke, L. Vandekerckhove, M. Yakubovsky, E. Sendagorta, J. L. Blanco,
E. Florence, D. Moschese, F. M. Maltez, A. Goorhuis, V. Pourcher, P.
Migaud, S. Noe, C. Pintado, F. Maggi, A.-B. E. Hansen, C. Hoffmann, J.
I. Lezama, C. Mussini, A. Cattelan, K. Makofane, D. Tan, S. Nozza, J.
Nemeth, M. B. Klein, and C. M. Orkin. 2022. <a href="https://doi.org/10.1056/NEJMoa2207323" class="external-link">Monkeypox
<span>Virus</span> <span>Infection</span> in <span>Humans</span> across
16 <span>Countries</span> — <span>April</span>–<span>June</span>
2022</a>. New England Journal of Medicine 387:679–691.
</div>
<div id="ref-wallinga_different_2004" class="csl-entry">
Wallinga, J., and P. Teunis. 2004. <a href="https://doi.org/10.1093/aje/kwh255" class="external-link">Different
<span>Epidemic</span> <span>Curves</span> for <span>Severe</span>
<span>Acute</span> <span>Respiratory</span> <span>Syndrome</span>
<span>Reveal</span> <span>Similar</span> <span>Impacts</span> of
<span>Control</span> <span>Measures</span></a>. American Journal of
Epidemiology 160:509–516.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert, Adam Kucharski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
